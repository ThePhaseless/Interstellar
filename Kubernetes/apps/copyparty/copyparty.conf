# =============================================================================
# Copyparty Configuration
# =============================================================================
# SMB: admin-only on local + Tailscale networks
# Web UI: non-admin users get read-only via IdP (Authentik)

[global]
# Web server settings
i: 0.0.0.0
p: 3923

# Reverse proxy mode - trust X-Forwarded-For from all sources (behind Traefik)
rproxy: 1

# IdP authentication (Authentik forward auth)
# Copyparty reads the user identity from headers injected by the reverse-proxy
# See https://github.com/9001/copyparty/blob/hovudstraum/docs/idp.md
auth-ord: idp
idp-h-usr: X-authentik-email
idp-h-grp: X-authentik-groups

# Trust IdP headers from any private/LAN IP (Traefik runs in-cluster)
xff-src: lan

# WebDAV settings - provides native file manager access
# Admin gets read-write via account permissions
daw

# Logging
lo: /dev/stdout

# Security
no-robots
no-logues

# Performance
j: 4
hist: 0

[accounts]
# Account credentials loaded from secrets (admin:pass, writer:pass)
%{inc:/cfg/secrets/admins}%
%{inc:/cfg/secrets/writers}%

[/personal]
  /personal
  accs:
    rwmda: admin
    r: writer

[/personal/public]
  /personal/public
  accs:
    rwmda: admin
    rw: writer

[/media]
  /media
  accs:
    r: admin, writer
