# =============================================================================
# Copyparty Configuration
# =============================================================================
# This file configures Copyparty with Google OAuth authentication via IdP
# and SMB access restricted to Tailscale network.

[global]
# Web server settings
i: 0.0.0.0
p: 3923

# IdP authentication (Google OAuth via OAuth2-Proxy)
auth-ord: idp
idp-h-usr: X-Forwarded-User

# SMB settings
smb: 3945
ipa: 100.64.0.0/10

# Logging
lo: /dev/stdout

# Security
no-robots: true
no-logues: true

# Performance
j: 4
hist: false

[accounts]
# Groups loaded from secrets (managed by External Secrets)
@admins: %{inc:/cfg/secrets/admins}%
@writers: %{inc:/cfg/secrets/writers}%

[/personal]
# Personal files - admins only
/personal
rwmda: @admins

[/personal/public]
# Public uploads - admins have full control, writers can upload, authenticated users can view
/personal/public
rwmda: @admins
rw: @writers
r: @acct

# SMB read access for specific Tailscale device (configure IP manually)
# r: guest
# ipu: 100.64.x.y=guest

[/media]
# Media library - read-only access
/media
r: @admins

# SMB read access
r: guest
